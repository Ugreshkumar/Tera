<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TeraBox Direct Link</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="manifest" href="manifest.json">
<style>
body{font-family:sans-serif;padding:1.2rem;max-width:480px;margin:auto}
input,button{width:100%;padding:.6rem;font-size:1rem;margin:.3rem 0}
#out{word-break:break-all;padding:.6rem;background:#f5f5f5;border-radius:6px}
small{color:#666}
</style>
</head>
<body>
<h2>üì• TeraBox Direct Link</h2>

<input id="link" placeholder="Paste share link e.g. https://terabox.com/s/abc123">
<input id="pwd"  placeholder="Password (leave blank if none)">
<button id="gen">Generate</button>

<div id="out" hidden></div>
<small id="note"></small>

<script>
async function getLink(){   // core logic
  const shareURL=document.getElementById('link').value.trim();
  const pwd=document.getElementById('pwd').value.trim();
  if(!shareURL){alert('Share link missing');return}
  const m=shareURL.match(/\/s\/([\w-]+)/);
  if(!m){alert('Invalid link');return}
  const short=m[1];
  const api=`https://terabox.com/share/list?app_id=250528&shorturl=${short}&dir=/&pwd=${encodeURIComponent(pwd)}`;
  try{
     const res=await fetch(api);  // CORS allowed
     const j=await res.json();
     if(j.errno!==0){throw new Error('API error: '+j.errno)}
     const {dlink,server_ctime,server_filename,filesize}=j.list[0];
     const direct=dlink+'&download';
     const out=document.getElementById('out');
     out.innerHTML=`<b>${server_filename}</b> (${(filesize/1e6).toFixed(1)}‚ÄØMB)<br>
        <a href="${direct}" target="_blank">${direct}</a>`;
     out.hidden=false;
     navigator.clipboard.writeText(direct).catch(()=>{});
     document.getElementById('note').textContent='üîó ‡§≤‡§ø‡§Ç‡§ï ‡§ï‡•ç‡§≤‡§ø‡§™‡§¨‡•ã‡§∞‡•ç‡§° ‡§Æ‡•á‡§Ç ‡§ï‡•â‡§™‡•Ä ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à (24‚ÄØ‡§ò‡§Ç‡§ü‡•á ‡§Æ‡•á‡§Ç expire)‡•§';
  }catch(e){
     alert(e.message);
  }
}
document.getElementById('gen').addEventListener('click',getLink);
</script>
</body>
</html>
